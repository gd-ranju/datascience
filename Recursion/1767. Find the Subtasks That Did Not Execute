
Write a solution to report the IDs of the missing subtasks for each task_id.


WITH RECURSIVE
    T(task_id, subtask_id) AS (
        -- Base case: Start with the task_id and the maximum subtask_id (subtasks_count) for each task
        SELECT
            task_id,
            subtasks_count
        FROM Tasks
        
        UNION ALL
        
        -- Recursive case: Generate the next subtask (decrease subtask_id by 1)
        -- Recursion continues as long as subtask_id > 1
        SELECT
            task_id,
            subtask_id - 1
        FROM t
        WHERE subtask_id > 1  -- Stop recursion once subtask_id reaches 1
    )
    
-- Final SELECT statement
SELECT
    T.*  -- Select task_id and subtask_id from the recursive CTE
FROM
    T
    LEFT JOIN Executed USING (task_id, subtask_id)  -- Left join with Executed table on task_id and subtask_id
WHERE
    Executed.subtask_id IS NULL;  -- Only return subtasks that have not been executed (i.e., where Executed.subtask_id is NULL)
